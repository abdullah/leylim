!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.editImage=t()}(this,function(){"use strict";var e=function(e,t,n){var i=document.createElement(e);if(n)for(var a in n)n.hasOwnProperty(a)&&i.setAttribute(a,n[a]);if(t)for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);return i},t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),i=function(){function e(n){var i=n.name,a=n.className;return t(this,e),this.button=document.createElement("button"),this.button.innerHTML=i,this.button.setAttribute("class",a||""),this.button.onclick=this.onclick.bind(this),this.image=null,this}return n(e,[{key:"getButton",value:function(){return this.button}},{key:"setPosition",value:function(e){var t=e.getBoundingClientRect(),n=t.left,i=t.top,a=e.clientHeight,o=e.clientWidth,l=this.button,u=l.clientHeight,r=l.clientWidth;this.button.style.left=n+o/2-r/2+"px",this.button.style.top=i+a/2-u/2+"px"}},{key:"listenArea",value:function(e){var t=this;e.addEventListener("mousemove",function(e){t.setPosition(e.target),"IMG"===e.target.tagName?(t.image=e.target,t.button.style.visibility="visible"):t.button.style.visibility="hidden"})}},{key:"onclick",value:function(){this.onButtonClick(this)}}]),e}();return{install:function(t,n){var a=t.nodes,o=a.LEYLIM_ROOT,l=a.AREA_NODE,u=t.$getModal({title:"EDIT IMAGE",button:{cancel:function(){},save:function(){}}}),r="",s=document.querySelector("."+o),c=document.querySelector("."+l),d=new i({name:"EDIT",className:"edit-image"});s.appendChild(d.getButton());var f=e("span",{innerHTML:"Source"},{class:"edit-image-title"}),p=e("span",{innerHTML:"Radius"},{class:"edit-image-title"}),m=e("input",null,{class:"edit-image-input-form"}),g=e("input",null,{value:"0",type:"range",min:"0",class:"edit-image-input-form"}),h=e("input",null,{value:"0",type:"file",name:"file",id:"file",class:"edit-image-input-form inputfile"}),v=e("label",{innerHTML:'<i class="fa fa-upload" aria-hidden="true"></i> Upload file'},{value:"0",for:"file"}),b=e("div",null,{class:"edit-image-modal-content"});b.appendChild(f),b.appendChild(m),b.appendChild(p),b.appendChild(g),n.onUploadFile&&(b.appendChild(h),b.appendChild(v)),u.setContent(b),u.onClose=function(){d.image.style.borderRadius="",d.image.src=r,u.close()},u.onSave=function(){d.image.src=m.value,d.image.style.borderRadius=g.value+"px",t.forceUpdate(),d.button.style.visibility="hidden",u.close()};var y=function(e){e.target.value&&(d.image.src=e.target.value)},C=function(e){n.onUploadFile(e.target.files,function(e){d.image.src=e,m.value=e})},k=function(e){d.image.style.borderRadius=e.target.value+"px"};d.onButtonClick=function(){r=d.image.src,m.value=d.image.src,g.max=d.image.clientWidth/2,m.oninput=y,g.oninput=k,h.onchange=C,u.open()},d.listenArea(c)}}});
