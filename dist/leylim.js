!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Leylim=t()}(this,function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),n=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},i=[],r=function(){function n(){e(this,n)}return t(n,[{key:"subscribe",value:function(e){i.push(e)}},{key:"unsubscribe",value:function(e){i=i.filter(function(t){return t!==e})}},{key:"fire",value:function(e,t,n){var o=n||window;i.forEach(function(n){n.call(o,e,t)})}}],[{key:"handlers",get:function(){return i}}]),n}(),a="ADD_COMPONENT",s="DUPLICATE_ROW",c="DELETE_ROW",l=function(i){function s(t){e(this,s);var n=o(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return n.component=t,n.render(),n}return n(s,r),t(s,[{key:"onclick",value:function(){this.fire(a,this.component,this)}},{key:"render",value:function(){var e=document.querySelector(".component-list"),t=document.createElement("a");t.onclick=this.onclick.bind(this),t.classList.add("component-list__item"),t.innerHTML=this.component.name,e.appendChild(t)}}]),s}(),u=function(){function n(t){e(this,n),this.options=t,this.listNode=null,this.init()}return t(n,[{key:"update",value:function(e){this.options.components=e,this.renderListItem()}},{key:"init",value:function(){var e=this.options.rootNode,t=document.querySelector(e),n=document.createElement("div");n.classList.add("component-list"),t.appendChild(n),this.listNode=n,this.renderListItem()}},{key:"renderListItem",value:function(){this.listNode.innerHTML="";for(var e=this.options.components,t=0;t<e.length;t++)new l(e[t])}}]),n}(),d=function(i){function a(t){e(this,a);var n=o(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return p.call(n),n.component=Object.assign({},t),n.rowNode=null,n.templateNode=null,n.actionsNode=null,n.rawHTMLmode=!1,n.actionButtons={ACTIONS_DUPLICATE:"row-duplicate",ACTIONS_DELETE:"row-delete",ACTIONS_HTML:"row-edit-as-html"},n}return n(a,r),t(a,[{key:"attachEvents",value:function(){var e=this,t=this.actionButtons,n=t.ACTIONS_DUPLICATE,o=t.ACTIONS_DELETE,i=t.ACTIONS_HTML,r=this.templateNode.querySelectorAll("[contenteditable]"),a=this.rowNode.querySelector("."+n),s=this.rowNode.querySelector("."+o),c=this.rowNode.querySelector("."+i);r.forEach(function(t){t.onblur=e.onUpdateRowTemplate}),a.onclick=this.onDuplicate,s.onclick=this.onDelete,c.onclick=this.changeMode}},{key:"render",value:function(e){var t=this.actionButtons,n=t.ACTIONS_DUPLICATE,o=t.ACTIONS_DELETE,i=t.ACTIONS_HTML;this.index=e;var r=document.querySelector(".leylim-area"),a=document.createElement("div");a.classList.add("leylim-area__row");var s=document.createElement("div");s.classList.add("row-template");var c=document.createElement("div");c.classList.add("row-actions"),c.innerHTML='\n      <a class="'+n+'">DUP</a>\n      <a class="'+o+'">DEL</a>\n      <a class="'+i+'">HMLT</a>\n    ',this.rowNode=a,this.templateNode=s,this.actionsNode=c,a.appendChild(s),a.appendChild(c),r.appendChild(a),this.renderContent(),this.attachEvents()}}]),a}(),p=function(){var e=this;this.onUpdateRowTemplate=function(){var t=e.templateNode.innerHTML;e.component.template=t,e.fire("UPDATE_ROW")},this.changeMode=function(){e.rawHTMLmode=!e.rawHTMLmode,e.renderContent()},this.renderContent=function(){e.rawHTMLmode?(e.templateNode.innerText=e.component.template,e.templateNode.setAttribute("contenteditable",!0),e.templateNode.classList.add("html-mode")):(e.templateNode.innerHTML=e.templateNode.innerText||e.component.template,e.templateNode.setAttribute("contenteditable",!1),e.templateNode.classList.remove("html-mode"),e.onUpdateRowTemplate()),e.attachEvents()},this.onDuplicate=function(t){t.preventDefault();var n=Object.assign({},e.component),o=e.index;e.fire(s,{component:n,index:o})},this.onDelete=function(t){t.preventDefault();var n=Object.assign({},e.component),o=e.index;e.fire(c,{component:n,index:o})}},h=function(i){function l(t){e(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));return n.handleEvents=function(e,t){switch(e){case a:n.addComponent(t);break;case s:n.duplicateRow(t);break;case c:n.deleteRow(t)}},n.options=t,n.rowList=[],n.subscribe(n.handleEvents),n.generateRow(),n.initArea(),n.render(),n}return n(l,r),t(l,[{key:"getRowData",value:function(){for(var e=[],t=this.rowList,n=0;n<t.length;n++){var o=Object.assign({},t[n].component);e.push(JSON.stringify(o))}return e}},{key:"generateRow",value:function(){for(var e=this.options.rowList,t=0;t<e.length;t++)this.rowList.push(new d(e[t],t))}},{key:"duplicateRow",value:function(e){this.rowList.splice(e.index+1,0,new d(e.component)),this.render()}},{key:"deleteRow",value:function(e){this.rowList.splice(e.index,1),this.render()}},{key:"addComponent",value:function(e){this.rowList.push(new d(e)),this.render()}},{key:"initArea",value:function(){var e=this.options.rootNode,t=document.querySelector(e),n=document.createElement("div");n.classList.add("leylim-area"),t.appendChild(n),this.areaNode=n}},{key:"render",value:function(){for(var e=this.areaNode;e.firstChild;)e.removeChild(e.firstChild);for(var t=0;t<this.rowList.length;t++)this.rowList[t].render(t)}}]),l}(),f=function(i){function a(t){e(this,a);var n=o(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return n.onShow=function(){n.fire()},n.options=t,n.init(),n}return n(a,r),t(a,[{key:"getButtons",value:function(e){var t=document.createElement("button");return t.classList.add("footer__button"),t.classList.add(e.class),t.innerText=e.text,t.onclick=e.handler,t}},{key:"init",value:function(){var e=this.options,t=e.rootNode,n=e.buttons,o=document.querySelector(t),i=document.createElement("div");i.classList.add("leylim-footer");for(var r=0;r<n.length;r++){var a=this.getButtons(n[r]);i.appendChild(a)}o.appendChild(i)}}]),a}();return function(i){function a(t){e(this,a);var n=o(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return n.options=t,n.init(),n}return n(a,r),t(a,[{key:"update",value:function(e){var t=e.components;this.options.components=t,this._list.update(t)}},{key:"getRowData",value:function(){return this._area.getRowData()}},{key:"init",value:function(){var e=this.options,t=e.components,n=e.el,o=e.rowList,i=e.buttons,r=document.querySelector(n),a=document.createElement("div");a.classList.add("leylim"),r.appendChild(a),this._list=new u({rootNode:".leylim",components:t}),this._area=new h({rootNode:".leylim",rowList:o}),this._footer=new f({rootNode:".leylim",buttons:i})}}],[{key:"use",value:function(){}}]),a}()});
//# sourceMappingURL=leylim.js.map
